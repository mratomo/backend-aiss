"""Settings for the attack-vulnerability-service."""

import os
from typing import Dict, List, Optional

from pydantic import BaseSettings, Field


class Settings(BaseSettings):
    """Application settings."""

    # Server settings
    debug: bool = Field(default=False, env="DEBUG")
    host: str = Field(default="0.0.0.0", env="HOST")
    port: int = Field(default=8400, env="PORT")
    app_name: str = Field(default="attack-vulnerability-service", env="APP_NAME")
    
    # CORS settings
    cors_origins: List[str] = Field(
        default=["*"], env="CORS_ORIGINS"
    )
    cors_headers: List[str] = Field(
        default=["*"], env="CORS_HEADERS"
    )
    
    # Auth
    auth_enabled: bool = Field(default=True, env="AUTH_ENABLED")
    api_key_header: str = Field(default="X-API-Key", env="API_KEY_HEADER")
    api_key: str = Field(default="", env="API_KEY")
    
    # ATT&CK CTI settings
    attack_cache_dir: str = Field(default="/app/cache", env="ATTACK_CACHE_DIR")
    attack_cache_ttl_hours: int = Field(default=24, env="ATTACK_CACHE_TTL_HOURS")
    
    # Vulnerability analysis settings
    high_severity_threshold: float = Field(default=0.8, env="HIGH_SEVERITY_THRESHOLD")
    medium_severity_threshold: float = Field(default=0.5, env="MEDIUM_SEVERITY_THRESHOLD")
    max_vulnerabilities_per_report: int = Field(default=50, env="MAX_VULNERABILITIES_PER_REPORT")
    
    # Logging
    log_level: str = Field(default="INFO", env="LOG_LEVEL")

    class Config:
        """Pydantic config."""

        env_file = ".env"